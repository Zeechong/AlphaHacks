<!DOCTYPE html>
<html>
    <head>
        <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="styles.css">
        <title>AlphaChat</title>
        <link rel="preconnect" href="https://fonts.gstatic.com">
       
    </head>
    <body>
        <h1>AlphaChat</h1>
        <input id="name" type="text" placeholder="your name"></input>
        <input id="message" type="text" placeholder="message"></input>
        <button id="send">Send</button>
        <div id="messages"></div>
        <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-database.js"></script>
        
        <script>
            // Your web app's Firebase configuration
            // For Firebase JS SDK v7.20.0 and later, measurementId is optional
            var firebaseConfig = {
                apiKey: "AIzaSyBL9XQXi--Ws3-P5HrD4dCJnAGqhK_eQo8",
                authDomain: "alphachat-a84b6.firebaseapp.com",
                databaseURL: "https://alphachat-a84b6-default-rtdb.firebaseio.com",
                projectId: "alphachat-a84b6",
                storageBucket: "alphachat-a84b6.appspot.com",
                messagingSenderId: "264349697001",
                appId: "1:264349697001:web:6ea110b08eae08075b8178",
                measurementId: "G-QNDR6FFZCP"
            };
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            let database = firebase.database();
            var name, message;
            function ready(){
                let Nname = document.getElementById("name").value;
                let Nmessage = document.getElementById('message').value;
                if(Nname === "" || Nmessage === ""){
                    alert("Please dont leave the name or message blank!");
                    return false;
                } else {
                    name = Nname;
                    message = Nmessage;
                }
            }

            document.getElementById("send").onclick = function(){
                if(ready()){
                    database.ref("talk").push({
                        nameOfSender : name,
                        sentMessage : message
                    })
                }
                
            }
            let msgCount = 0;
            database.ref("talk").on('child_added', function(message) {
            
            let messages = document.getElementById("messages");
            let name = message.val().nameOfSender;
            let value = message.val().sentMessage;

            let div = document.createElement("div");
            let span = document.createElement("span");
            span.innerHTML = "@" + name;
            let p = document.createElement("p");
            p.innerHTML = value;
            
            if(msgCount%2==0){
                div.classList.add('gray');
            }
            msgCount++;

            div.appendChild(span);
            div.appendChild(p);

            messages.appendChild(div);
            messages.scrollTop = messages.scrollHeight;
            // <div>, span, p </div>

            })

        </script>
    </body>
</html>